<?xml version="1.0"?>

<config>
    <modules>
        <Testimonial_Avtoto>
            <version>0.2.3</version>
        </Testimonial_Avtoto>
    </modules>
    <global>
        <models>
            <avtoto>
                <class>Testimonial_Avtoto_Model</class>
                <resourceModel>avtoto_resource</resourceModel>
            </avtoto>
            <avtoto_resource>
                <class>Testimonial_Avtoto_Model_Resource</class>
                <entities>
                    <import_retailer>
                        <table>import_retailer</table>
                    </import_retailer>
                    <import_retailer_tmp>
                        <table>import_retailer_tmp</table>
                    </import_retailer_tmp>
                    <directory_offer_link>
                        <table>directory_offer_link</table>
                    </directory_offer_link>
                    <directory_offer_link_tmp>
                        <table>directory_offer_link_tmp</table>
                    </directory_offer_link_tmp>
                    <retailer>
                        <table>retailers</table>
                    </retailer>
                    <product>
                        <table>SS_products</table>
                    </product>
                    <autopricing_process_status>
                        <table>avtoto_autopricing_process_status</table>
                    </autopricing_process_status>
                </entities>
            </avtoto_resource>
            <customer>
                <rewrite>
                    <session>Testimonial_Avtoto_Model_Customer_Session</session>
                </rewrite>
            </customer>
            <customer_resource>
                <rewrite>
                    <customer_collection>Testimonial_Avtoto_Model_Resource_Customer_Collection</customer_collection>
                </rewrite>
            </customer_resource>
        </models>
        <resources>
            <avtoto_setup>
                <setup>
                    <module>Testimonial_Avtoto</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </avtoto_setup>
        </resources>
        <blocks>
            <avtoto>
                <class>Testimonial_Avtoto_Block</class>
            </avtoto>
            <payment>
                <rewrite>
                    <form_purchaseorder>Testimonial_Avtoto_Block_Payment_Form_Purchaseorder</form_purchaseorder>
                </rewrite>
            </payment>
            <customer>
                <rewrite>
                    <account_navigation>Testimonial_Avtoto_Block_Customer_Account_Navigation</account_navigation>
                </rewrite>
            </customer>
            <adminhtml>
                <rewrite>
                    <permissions_user_edit_tab_roles>Testimonial_Avtoto_Block_Adminhtml_Permissions_User_Edit_Tab_Roles</permissions_user_edit_tab_roles>
                </rewrite>
            </adminhtml>
        </blocks>
        <helpers>
            <avtoto>
                <class>Testimonial_Avtoto_Helper</class>
            </avtoto>
        </helpers>
        <events>
            <sales_order_invoice_register>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>sales_order_invoice_register</method>
                    </testimonial_avtoto>
                </observers>
            </sales_order_invoice_register>
            <sales_order_invoice_cancel>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>sales_order_invoice_cancel</method>
                    </testimonial_avtoto>
                </observers>
            </sales_order_invoice_cancel>
            <sales_order_payment_cancel_invoice>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>sales_order_payment_cancel_invoice</method>
                    </testimonial_avtoto>
                </observers>
            </sales_order_payment_cancel_invoice>
            <sales_order_save_after>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>sales_order_save_after</method>
                    </testimonial_avtoto>
                </observers>
            </sales_order_save_after>
            <magedoc_order_supply_status_change>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>magedoc_order_supply_status_change</method>
                    </testimonial_avtoto>
                </observers>
            </magedoc_order_supply_status_change>
        </events>
        <bookkeeping>
            <order_model>magedoc/order</order_model>
            <form_class>MageDoc_System_Block_Adminhtml_Form_Extended</form_class>
        </bookkeeping>
        <autopricing>
            <process>
                <retailer_price_updated>
                    <title>Retailer prices update</title>
                    <sort_order>0</sort_order>
                </retailer_price_updated>
                <retailers_syncronized>
                    <model>avtoto/price</model>
                    <method>updateShopRetailersTable</method>
                    <title>Retailers data is synchronized</title>
                    <sort_order>10</sort_order>
                </retailers_syncronized>
                <retailer_prices_syncronized>
                    <model>avtoto/price</model>
                    <method>updateShopPriceTable</method>
                    <title>Retailers prices are synchronized</title>
                    <sort_order>20</sort_order>
                </retailer_prices_syncronized>
                <flatcatalog_final_price_update>
                    <model>flatcatalog/product</model>
                    <method>updateFinalPrice</method>
                    <title>Flat catalog final price update</title>
                    <sort_order>30</sort_order>
                </flatcatalog_final_price_update>
                <shop_price_updated>
                    <model>avtoto/price</model>
                    <method>updateShopCatalog</method>
                    <title>Shop catalog prices and quantities are updated</title>
                    <sort_order>40</sort_order>
                </shop_price_updated>
                <catalog_updated>
                    <model>avtoto/price</model>
                    <method>updateCatalog</method>
                    <title>Magento catalog is updated from shop</title>
                    <sort_order>50</sort_order>
                </catalog_updated>
                <shop_price_synchronized>
                    <model>avtoto/price</model>
                    <method>updateShopPrices</method>
                    <title>Shop prices &amp; stock are updated using Magento final_price &amp; stock_item</title>
                    <sort_order>60</sort_order>
                </shop_price_synchronized>
            </process>
        </autopricing>
        <magedoc>
            <import_parser_models module="magedoc">
                <tecdoc_base_vlad translate="label">
                    <label>TecDoc Base Vladislav</label>
                    <class>avtoto/retailer_data_import_vladislav</class>
                </tecdoc_base_vlad>
            </import_parser_models>
        </magedoc>
        <novaposhta>
            <order_model>magedoc/order</order_model>
        </novaposhta>
    </global>
    <adminhtml>
        <layout>
            <updates>
                <avtoto>
                    <file>avtoto.xml</file>
                </avtoto>
            </updates>
        </layout>
        <events>
            <magedoc_category_edit_prepare_form>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>magedoc_category_edit_prepare_form</method>
                    </testimonial_avtoto>
                </observers>
            </magedoc_category_edit_prepare_form>
            <magedoc_import_price>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Autopricing_Observer</class>
                        <method>updateStatusesOfPriceDependedProcesses</method>
                    </testimonial_avtoto>
                </observers>
            </magedoc_import_price>
            <magedoc_retailer_save_after>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Autopricing_Observer</class>
                        <method>updateStatusesOfRetailerDependedProcesses</method>
                    </testimonial_avtoto>
                </observers>
            </magedoc_retailer_save_after>
            <novaposhta_warehouse_update_complete>
                <observers>
                    <testimonial_avtoto>
                        <type>singleton</type>
                        <class>Testimonial_Avtoto_Model_Observer</class>
                        <method>novaposhta_warehouse_update_complete</method>
                    </testimonial_avtoto>
                </observers>
            </novaposhta_warehouse_update_complete>
        </events>
    </adminhtml>
    <default>
        <magedoc>
            <import>
                <price_discount_table>a:5:{s:18:"_1423151223912_912";a:2:{s:11:"lower_limit";s:1:"0";s:5:"value";s:2:"10";}s:18:"_1423153566151_151";a:2:{s:11:"lower_limit";s:2:"50";s:5:"value";s:2:"12";}s:17:"_1423153567072_72";a:2:{s:11:"lower_limit";s:3:"200";s:5:"value";s:2:"15";}s:18:"_1423153567873_873";a:2:{s:11:"lower_limit";s:3:"500";s:5:"value";s:2:"20";}s:18:"_1423153568946_946";a:2:{s:11:"lower_limit";s:4:"1000";s:5:"value";s:2:"25";}}</price_discount_table>
                <price_margin_table>a:7:{s:17:"_1423151225028_28";a:2:{s:11:"lower_limit";s:1:"0";s:5:"value";s:3:"100";}s:18:"_1423153638812_812";a:2:{s:11:"lower_limit";s:1:"5";s:5:"value";s:2:"50";}s:18:"_1423153639795_795";a:2:{s:11:"lower_limit";s:3:"100";s:5:"value";s:2:"40";}s:18:"_1423153640735_735";a:2:{s:11:"lower_limit";s:3:"200";s:5:"value";s:2:"35";}s:18:"_1423153641805_805";a:2:{s:11:"lower_limit";s:3:"500";s:5:"value";s:2:"27";}s:18:"_1423153647415_415";a:2:{s:11:"lower_limit";s:4:"1000";s:5:"value";s:2:"25";}s:18:"_1423153676175_175";a:2:{s:11:"lower_limit";s:4:"3000";s:5:"value";s:2:"20";}}</price_margin_table>
            </import>
        </magedoc>
        <carriers>
            <novaposhta>
                <sender_city>13</sender_city>
                <sender_company>AvtoTo</sender_company>
                <sender_address>ул. Юрьевская 2</sender_address>
                <sender_contact>СПД-ФЛ Литвин С.А. Свидетельство о гос. регистрации 580848 </sender_contact>
                <sender_phone>(067)577-09-15</sender_phone>
            </novaposhta>
            <pickup>
                <active>0</active>
            </pickup>
        </carriers>
        <sugarcrm>
            <general>
                <call_description>Клиент {{getOrder()/getCustomerName()}}: {{@comment}}</call_description>
            </general>
        </sugarcrm>
        <magedoc_orderexport>
            <settings>
                <notification_email_recepient>shevtsova.avtoto@gmail.com</notification_email_recepient>
            </settings>
        </magedoc_orderexport>
    </default>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <avtoto before="Mage_Adminhtml">Testimonial_Avtoto_Adminhtml</avtoto>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>
</config>